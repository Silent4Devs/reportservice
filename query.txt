
        select 
        a.area as "√Åreas",
        count(tt.tarea) as "Tareas Asignadas del Proyecto" ,
        sum(
            coalesce(cast(nullif(th.horas_lunes, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_martes, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_miercoles, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_jueves, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_viernes, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_sabado, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_domingo, '') as numeric), 0)
        ) as "Horas invertidas"
        from timesheet_proyectos tp 
        inner join timesheet_tareas tt on tp.id=tt.proyecto_id 
        inner join areas a on tt.area_id=a.id 
        inner join timesheet_horas th on tt.id =th.tarea_id 
    
        group by 
            a.area,
            tp.proyecto,
            tp.fecha_inicio, 
            tp.estatus
        order by a.area
    