
        select 
        e.name as "Empleado",
                sum(
            coalesce(cast(nullif(th.horas_lunes, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_martes, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_miercoles, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_jueves, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_viernes, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_sabado, '') as numeric), 0) +
            coalesce(cast(nullif(th.horas_domingo, '') as numeric), 0)
        ) as "Horas trabajadas en proyecto"
        from timesheet_proyectos tp 
        left join timesheet_tareas tt on tp.id=tt.proyecto_id  
        inner join timesheet_horas th on tt.id =th.tarea_id 
        inner join empleados e on th.empleado_id =e.id
        left join areas a on e.area_id =a.id
        where 1=1
    
        group by 
            a.area,
            e.name,
            tp.proyecto
        order by a.area
    